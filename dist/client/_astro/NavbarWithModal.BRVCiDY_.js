import{c as L,j as e,B as r}from"./createLucideIcon.C9qM8KNi.js";import{r as a}from"./index.CY-HDqYb.js";import{H as ae,N as te}from"./Navbar.ryZaWJbh.js";import{I as q}from"./input.DQP1lckO.js";import{C as w,a as C,b as S,c as _}from"./card.CwskAJbJ.js";import{B as E}from"./badge.Qd5udzr1.js";import{b as p}from"./api.a2yr6dSM.js";import{X as re,C as ie}from"./x.Bdr1dCcl.js";import{U as le}from"./user.DwRibW2I.js";import{C as F,a as ne}from"./clock.ih07b0yA.js";import{R as j}from"./refresh-cw.XVD5AAyh.js";import{S as X}from"./settings.B1k9k4J7.js";import{V as $}from"./video.C0_GaG-H.js";import{E as ce}from"./eye.s3Nkw_SD.js";import{D as de}from"./download.BOBObm7a.js";import{C as oe}from"./circle-x.CtdoWOcc.js";import{C as me}from"./circle-check-big.btNzbIIr.js";import"./credit-card.DBZyheI9.js";import"./sparkles.Bh5ZbUvE.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],ue=L("calendar",xe);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],pe=L("chevron-left",he);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],fe=L("chevron-right",je);function ge({isOpen:x,onClose:f}){const[l,c]=a.useState("email"),[n,M]=a.useState(""),[u,D]=a.useState(""),[P,H]=a.useState(null),[g,N]=a.useState(!1),[k,i]=a.useState(null),[Ne,K]=a.useState(!1),[h,T]=a.useState(0),[R,O]=a.useState([]),[b,z]=a.useState(null),[d,A]=a.useState(1),[y,U]=a.useState(1),[W,J]=a.useState(0),[o,v]=a.useState(!1);a.useEffect(()=>{x&&(c("email"),M(""),D(""),H(null),i(null),K(!1),T(0),O([]),z(null),A(1))},[x]),a.useEffect(()=>{if(h>0){const s=setTimeout(()=>T(h-1),1e3);return()=>clearTimeout(s)}},[h]);const I=async()=>{if(!n.trim()){i("Email tidak boleh kosong");return}try{N(!0),i(null),await p.requestOTP(n),K(!0),c("otp"),T(60)}catch(s){i(s instanceof Error?s.message:"Gagal mengirim OTP")}finally{N(!1)}},B=async()=>{if(!u.trim()){i("OTP tidak boleh kosong");return}try{N(!0),i(null);const s=await p.verifyOTP(n,u);H(s.data["x-api-key"]),c("history"),await G(s.data["x-api-key"])}catch(s){i(s instanceof Error?s.message:"Gagal verifikasi OTP")}finally{N(!1)}},G=async s=>{try{v(!0);const[t,m]=await Promise.all([p.getVideoList(s,d,5),p.getCoinBalance(s)]);O(t.data),U(t.last_page),J(t.total),z(m.data)}catch(t){i(t instanceof Error?t.message:"Gagal memuat data")}finally{v(!1)}},V=async s=>{if(!(!P||s<1||s>y)){A(s);try{v(!0);const t=await p.getVideoList(P,s,5);O(t.data)}catch(t){i(t instanceof Error?t.message:"Gagal memuat halaman")}finally{v(!1)}}},Q=s=>{switch(s.toLowerCase()){case"success":return e.jsx(me,{className:"w-4 h-4 text-green-600"});case"progress":return e.jsx(j,{className:"w-4 h-4 text-blue-600 animate-spin"});case"failed":return e.jsx(oe,{className:"w-4 h-4 text-red-600"});default:return e.jsx(ne,{className:"w-4 h-4 text-gray-600"})}},Y=s=>{switch(s.toLowerCase()){case"success":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200";case"progress":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200";case"failed":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"}},Z=s=>{switch(s.toLowerCase()){case"success":return"Selesai";case"progress":return"Diproses";case"failed":return"Gagal";default:return"Menunggu"}},ee=s=>new Date(s).toLocaleDateString("id-ID",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),se=s=>{s.status_video==="success"&&s.url_video&&window.open(s.url_video,"_blank")};return x?e.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:f}),e.jsxs("div",{className:"relative bg-background rounded-xl shadow-2xl w-full max-w-6xl max-h-[90vh] overflow-hidden mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 dark:bg-purple-900/30 rounded-lg flex items-center justify-center",children:e.jsx(ae,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-foreground",children:"Riwayat Video"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[l==="email"&&"Masukkan email untuk mengakses riwayat",l==="otp"&&"Verifikasi OTP yang dikirim ke email",l==="history"&&"Daftar video dan saldo koin Anda"]})]})]}),e.jsx(r,{variant:"ghost",size:"icon",onClick:f,children:e.jsx(re,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-120px)]",children:[l==="email"&&e.jsx("div",{className:"max-w-md mx-auto",children:e.jsxs(w,{children:[e.jsx(C,{children:e.jsxs(S,{className:"flex items-center space-x-2",children:[e.jsx(le,{className:"w-5 h-5"}),e.jsx("span",{children:"Masukkan Email"})]})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Email"}),e.jsx(q,{type:"email",placeholder:"Masukkan email Anda...",value:n,onChange:s=>M(s.target.value),onKeyPress:s=>s.key==="Enter"&&I()})]}),k&&e.jsxs("div",{className:"flex items-center p-3 bg-red-50 dark:bg-red-950/20 border border-red-200 dark:border-red-800 rounded-lg",children:[e.jsx(F,{className:"w-4 h-4 text-red-600 dark:text-red-400 mr-2"}),e.jsx("span",{className:"text-sm text-red-800 dark:text-red-200",children:k})]}),e.jsx(r,{onClick:I,disabled:g||!n.trim(),className:"w-full",children:g?e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"w-4 h-4 mr-2 animate-spin"}),"Mengirim OTP..."]}):"Kirim OTP"})]})]})}),l==="otp"&&e.jsx("div",{className:"max-w-md mx-auto",children:e.jsxs(w,{children:[e.jsx(C,{children:e.jsxs(S,{className:"flex items-center space-x-2",children:[e.jsx(X,{className:"w-5 h-5"}),e.jsx("span",{children:"Verifikasi OTP"})]})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Kode OTP telah dikirim ke:"}),e.jsx("p",{className:"font-medium text-foreground",children:n})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Kode OTP"}),e.jsx(q,{type:"text",placeholder:"Masukkan 6 digit OTP...",value:u,onChange:s=>D(s.target.value.replace(/\D/g,"").slice(0,6)),onKeyPress:s=>s.key==="Enter"&&B(),maxLength:6})]}),h>0&&e.jsx("div",{className:"text-center",children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Kirim ulang OTP dalam ",h," detik"]})}),k&&e.jsxs("div",{className:"flex items-center p-3 bg-red-50 dark:bg-red-950/20 border border-red-200 dark:border-red-800 rounded-lg",children:[e.jsx(F,{className:"w-4 h-4 text-red-600 dark:text-red-400 mr-2"}),e.jsx("span",{className:"text-sm text-red-800 dark:text-red-200",children:k})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{onClick:B,disabled:g||!u.trim()||u.length!==6,className:"w-full",children:g?e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"w-4 h-4 mr-2 animate-spin"}),"Memverifikasi..."]}):"Verifikasi OTP"}),e.jsx(r,{variant:"outline",onClick:()=>c("email"),className:"w-full",children:"Kembali ke Email"})]})]})]})}),l==="history"&&e.jsxs("div",{className:"space-y-6",children:[b&&e.jsxs(w,{className:"bg-gradient-to-r from-purple-50 to-blue-50 dark:from-purple-950/20 dark:to-blue-950/20 border-purple-200 dark:border-purple-800",children:[e.jsx(C,{children:e.jsxs(S,{className:"flex items-center space-x-2",children:[e.jsx(ie,{className:"w-5 h-5 text-purple-600"}),e.jsx("span",{children:"Saldo Koin"})]})}),e.jsx(_,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:b.quota.toLocaleString()}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Koin"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:b.hari_ini.toLocaleString()}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Hari Ini"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-green-600",children:b.minggu_ini.toLocaleString()}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Minggu Ini"})]})]})})]}),e.jsxs(w,{children:[e.jsx(C,{children:e.jsxs(S,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx($,{className:"w-5 h-5"}),e.jsxs("span",{children:["Daftar Video (",W,")"]})]}),e.jsxs(r,{variant:"outline",size:"sm",onClick:()=>G(P),disabled:o,children:[e.jsx(j,{className:`w-4 h-4 mr-2 ${o?"animate-spin":""}`}),"Refresh"]})]})}),e.jsxs(_,{children:[o?e.jsxs("div",{className:"flex justify-center items-center py-8",children:[e.jsx(j,{className:"w-6 h-6 animate-spin mr-2"}),e.jsx("span",{children:"Memuat data..."})]}):R.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx($,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Belum ada video yang dibuat"})]}):e.jsx("div",{className:"space-y-4",children:R.map(s=>e.jsx("div",{className:"p-4 border rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsxs(E,{className:Y(s.status_video),children:[Q(s.status_video),e.jsx("span",{className:"ml-1",children:Z(s.status_video)})]}),e.jsx(E,{variant:"outline",children:s.model_ai}),e.jsx(E,{variant:"outline",children:s.aspect_ratio})]}),e.jsx("p",{className:"text-sm text-foreground mb-2 line-clamp-2",children:s.prompt}),e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ue,{className:"w-3 h-3"}),e.jsx("span",{children:ee(s.created_at)})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(X,{className:"w-3 h-3"}),e.jsx("span",{children:s.resolusi_video})]})]})]}),s.status_video==="success"&&s.url_video&&e.jsxs("div",{className:"flex space-x-2 ml-4",children:[e.jsxs(r,{size:"sm",variant:"outline",onClick:()=>se(s),children:[e.jsx(ce,{className:"w-4 h-4 mr-1"}),"Lihat"]}),e.jsxs(r,{size:"sm",variant:"outline",onClick:()=>window.open(s.url_video,"_blank"),children:[e.jsx(de,{className:"w-4 h-4 mr-1"}),"Download"]})]})]})},s.id))}),y>1&&e.jsxs("div",{className:"flex items-center justify-center space-x-2 mt-6",children:[e.jsx(r,{variant:"outline",size:"sm",onClick:()=>V(d-1),disabled:d===1||o,children:e.jsx(pe,{className:"w-4 h-4"})}),e.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(5,y)},(s,t)=>{const m=t+1;return e.jsx(r,{variant:d===m?"default":"outline",size:"sm",onClick:()=>V(m),disabled:o,children:m},m)})}),e.jsx(r,{variant:"outline",size:"sm",onClick:()=>V(d+1),disabled:d===y||o,children:e.jsx(fe,{className:"w-4 h-4"})})]})]})]})]})]})]})]}):null}function ze({currentStep:x=1,totalSteps:f=4}){const[l,c]=a.useState(!1),n=()=>{c(!0)};return e.jsxs(e.Fragment,{children:[e.jsx(te,{currentStep:x,totalSteps:f,onVideoHistoryClick:n}),e.jsx(ge,{isOpen:l,onClose:()=>c(!1)})]})}export{ze as NavbarWithModal};
