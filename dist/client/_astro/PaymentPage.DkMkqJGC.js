import{c as G,j as e,B as h}from"./createLucideIcon.C9qM8KNi.js";import{r as t}from"./index.CY-HDqYb.js";import{I as V}from"./input.DQP1lckO.js";import{C as E,a as R,b as $,c as D}from"./card.CwskAJbJ.js";import{B as F}from"./badge.Qd5udzr1.js";import{o as q,a as A}from"./api.a2yr6dSM.js";import{X as J,C as L}from"./x.Bdr1dCcl.js";import{M as Y}from"./mail.C1wlOqJB.js";import{a as Z,C as ee}from"./clock.ih07b0yA.js";import{C as ae}from"./circle-check-big.btNzbIIr.js";import{v as m}from"./videoSetupStorage.Fc38nvc3.js";import{C as I}from"./credit-card.DBZyheI9.js";import{V as se}from"./video.C0_GaG-H.js";import{C as P}from"./check.DRUMQLy0.js";import{U as te}from"./user.DwRibW2I.js";import{A as re}from"./arrow-left.CPws6s8x.js";import{P as ie}from"./play.vIkBtBUm.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]],ne=G("qr-code",le);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],B=G("wallet",de);function oe({isOpen:K,onClose:C,email:i,onSuccess:y}){const[l,g]=t.useState(""),[S,_]=t.useState(!1),[f,T]=t.useState(!1),[d,o]=t.useState(null),[b,j]=t.useState(null),[N,p]=t.useState(!1),[c,k]=t.useState(0),n=async()=>{try{T(!0),o(null);const r=await q.requestOTP({email:i});if(r.status){p(!0),j("OTP telah dikirim ke email Anda"),k(60);const w=setInterval(()=>{k(x=>x<=1?(clearInterval(w),0):x-1)},1e3)}else o(r.message||"Gagal mengirim OTP")}catch(r){o(r instanceof Error?r.message:"Gagal mengirim OTP")}finally{T(!1)}},O=async()=>{if(l.length!==6){o("OTP harus 6 digit");return}try{_(!0),o(null);const r=await q.validateOTP({email:i,otp:parseInt(l)});r.status&&r.data?(j("OTP berhasil divalidasi!"),setTimeout(()=>{y(r.data.quota),C()},1500)):o(r.message||"OTP tidak valid")}catch(r){o(r instanceof Error?r.message:"Gagal memvalidasi OTP")}finally{_(!1)}},v=()=>{g(""),o(null),j(null),p(!1),k(0),C()};return K?e.jsx("div",{className:"fixed inset-0 bg-black/30 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs(E,{className:"w-full max-w-md bg-white/95 dark:bg-gray-900/95 backdrop-blur-md border border-white/20 dark:border-gray-700/50 shadow-2xl",children:[e.jsxs(R,{className:"flex flex-row items-center justify-between",children:[e.jsx($,{className:"text-xl font-semibold",children:"Verifikasi OTP"}),e.jsx(h,{variant:"ghost",size:"sm",onClick:v,className:"h-8 w-8 p-0",children:e.jsx(J,{className:"h-4 w-4"})})]}),e.jsxs(D,{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsx(Y,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Email"}),e.jsx("p",{className:"font-medium text-foreground",children:i})]})]}),!N&&e.jsx("div",{className:"text-center",children:e.jsx(h,{onClick:n,disabled:f,className:"w-full",children:f?"Mengirim...":"Kirim OTP"})}),N&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Masukkan Kode OTP"}),e.jsx(V,{type:"text",placeholder:"123456",value:l,onChange:r=>{const w=r.target.value.replace(/\D/g,"").slice(0,6);g(w),o(null)},className:"text-center text-lg tracking-widest",maxLength:6})]}),e.jsx("div",{className:"text-center",children:c>0?e.jsxs("div",{className:"flex items-center justify-center space-x-2 text-sm text-muted-foreground",children:[e.jsx(Z,{className:"w-4 h-4"}),e.jsxs("span",{children:["Kirim ulang dalam ",c,"s"]})]}):e.jsx(h,{variant:"outline",size:"sm",onClick:n,disabled:f,children:f?"Mengirim...":"Kirim Ulang OTP"})}),e.jsx(h,{onClick:O,disabled:S||l.length!==6,className:"w-full",children:S?"Memvalidasi...":"Verifikasi OTP"})]}),d&&e.jsxs("div",{className:"flex items-center space-x-2 p-3 bg-red-50 dark:bg-red-950/20 border border-red-200 dark:border-red-800 rounded-lg",children:[e.jsx(ee,{className:"w-4 h-4 text-red-600 dark:text-red-400"}),e.jsx("span",{className:"text-sm text-red-800 dark:text-red-200",children:d})]}),b&&e.jsxs("div",{className:"flex items-center space-x-2 p-3 bg-green-50 dark:bg-green-950/20 border border-green-200 dark:border-green-800 rounded-lg",children:[e.jsx(ae,{className:"w-4 h-4 text-green-600 dark:text-green-400"}),e.jsx("span",{className:"text-sm text-green-800 dark:text-green-200",children:b})]})]})]})}):null}function Se(){const[K,C]=t.useState(""),[i,y]=t.useState(""),[l,g]=t.useState(""),[S,_]=t.useState(""),[f,T]=t.useState(""),[d,o]=t.useState(null),[b,j]=t.useState(!1),[N,p]=t.useState(!1),[c,k]=t.useState(null),[n,O]=t.useState(!1),[v,r]=t.useState(!1),[w,x]=t.useState(null);t.useEffect(()=>{m.debug();const a=m.load();console.log("Loading existing data from localStorage:",a),a&&(a.email&&y(a.email),a.no_wa&&g(a.no_wa))},[]),t.useEffect(()=>{M()},[i,l]);const M=()=>{const a=i.trim()!==""&&l.trim()!=="";console.log("Personal info validation:",{email:i.trim(),phoneNumber:l.trim(),isComplete:a}),j(a)},z=async a=>{k(a),O(!0),p(!1),m.updatePaymentInfo({email:i,no_wa:l,metode_pengiriman:"kuota",metode:null,jumlah:1e4})},H=()=>{i.trim()!==""&&p(!0)},Q=async a=>{o(a);const u=1e4;if(a==="coins")n&&m.updatePaymentInfo({email:i,no_wa:l,metode_pengiriman:"kuota",metode:null,jumlah:u});else{let s=null;a==="gopay"?s="gopay":a==="qris"?s="other_qris":a==="credit-card"&&(s="kreem"),m.updatePaymentInfo({email:i,no_wa:l,metode_pengiriman:"pembayaran",metode:s,jumlah:u})}},U=async()=>{try{r(!0),x(null);const a=m.load();if(!a)throw new Error("Data video tidak ditemukan. Silakan kembali ke halaman setup.");const u={prompt:a.prompt,karakter_image:a.karakter_image,background_image:a.background_image,aspek_rasio:a.aspek_rasio,seeds:null,model_ai:"veo3_fast",metode_pengiriman:"kuota",metode:null,jumlah:a.jumlah,email:a.email||i,no_wa:a.no_wa||l,affiliate_by:""},s=await A.storeVideoData(u);if(s.status)console.log("Video data stored successfully with coins:",s.message),s.data&&s.data["x-api-key"]&&localStorage.setItem("x-api-key",s.data["x-api-key"]),window.location.href="/generate";else throw new Error(s.message||"Gagal menyimpan data video")}catch(a){console.error("Error processing coins payment:",a),x(a instanceof Error?a.message:"Terjadi kesalahan saat memproses pembayaran dengan koin")}finally{r(!1)}},W=async()=>{try{r(!0),x(null);const a=m.load();if(!a)throw new Error("Data video tidak ditemukan. Silakan kembali ke halaman setup.");const u={prompt:a.prompt,karakter_image:a.karakter_image,background_image:a.background_image,aspek_rasio:a.aspek_rasio,seeds:null,model_ai:"veo3_fast",metode_pengiriman:a.metode_pengiriman||"pembayaran",metode:a.metode,jumlah:a.jumlah,email:a.email||i,no_wa:a.no_wa||l,affiliate_by:""},s=await A.storeVideoData(u);if(s.status)console.log("Video data stored successfully:",s.message),s.data&&s.data["x-api-key"]&&localStorage.setItem("x-api-key",s.data["x-api-key"]),s.data&&s.data.invoice?window.location.href=`/transaksi/${s.data.invoice}`:alert("Pembayaran berhasil! Video Anda sedang diproses.");else throw new Error(s.message||"Gagal menyimpan data video")}catch(a){console.error("Error processing payment:",a),x(a instanceof Error?a.message:"Terjadi kesalahan saat memproses pembayaran")}finally{r(!1)}},X=[{id:"coins",name:"Gunakan Koin",description:n?`Saldo: ${c?.toLocaleString()} Koin`:"Verifikasi OTP terlebih dahulu",icon:e.jsx(L,{className:"w-6 h-6"}),balance:c?`${c.toLocaleString()} Koin`:"0 Koin",disabled:!n||c!==null&&c<7500},{id:"gopay",name:"Gopay",description:n?"Pembayaran dengan Gopay":"Verifikasi email terlebih dahulu",icon:e.jsx(B,{className:"w-6 h-6"}),disabled:!n},{id:"qris",name:"QRIS",description:n?"Pembayaran dengan QRIS":"Verifikasi email terlebih dahulu",icon:e.jsx(ne,{className:"w-6 h-6"}),disabled:!n},{id:"credit-card",name:"Kartu Kredit dan Internasional",description:n?"Pembayaran dengan Kartu Kredit dan Internasional":"Verifikasi email terlebih dahulu",icon:e.jsx(I,{className:"w-6 h-6"}),disabled:!n}];return e.jsx("div",{className:"w-full min-h-screen  dark:from-gray-900 dark:to-gray-800",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h1",{className:"text-4xl font-bold text-foreground mb-4",children:"Pembayaran Video AI"}),e.jsx("p",{className:"text-lg text-muted-foreground max-w-3xl mx-auto",children:"Lengkapi informasi pembayaran untuk melanjutkan proses pembuatan video AI Anda"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12",children:[e.jsxs(E,{className:"bg-card shadow-xl border-0",children:[e.jsxs("div",{className:"bg-gradient-to-br from-purple-600 to-blue-600 text-white px-8 py-8 flex flex-col items-center w-full",children:[e.jsxs("div",{className:"flex items-center mb-4 w-full justify-center",children:[e.jsx("div",{className:"w-16 h-16 bg-white/20 rounded-full flex items-center justify-center mr-6",children:e.jsx(se,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold",children:"Video AI"}),e.jsx("p",{className:"text-white/80 text-lg",children:"Harga tetap per video"})]})]}),e.jsx("div",{className:"text-5xl font-extrabold mb-2 w-full text-center",children:"Rp 7.500"}),e.jsx("p",{className:"text-white/80 text-lg w-full text-center",children:"1 Video HD berkualitas tinggi"})]}),e.jsxs(D,{className:"p-6",children:[e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"w-6 h-6 bg-green-100 rounded-full flex items-center justify-center mr-3 mt-0.5",children:e.jsx(P,{className:"w-4 h-4 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground",children:"Video HD Berkualitas Tinggi"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Resolusi 720p atau 1080p sesuai pilihan"})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"w-6 h-6 bg-green-100 rounded-full flex items-center justify-center mr-3 mt-0.5",children:e.jsx(P,{className:"w-4 h-4 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground",children:"Karakter & Background Custom"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Pilihan karakter AI dan background sesuai keinginan"})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"w-6 h-6 bg-green-100 rounded-full flex items-center justify-center mr-3 mt-0.5",children:e.jsx(P,{className:"w-4 h-4 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground",children:"Download Langsung"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Unduh video setelah proses selesai"})]})]})]}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-950/30 p-4 rounded-lg border border-blue-200 dark:border-blue-800",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(L,{className:"w-5 h-5 text-blue-600 dark:text-blue-400 mr-3 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-semibold text-blue-800 dark:text-blue-200 mb-1",children:"Rincian Penggunaan:"}),e.jsxs("p",{className:"text-blue-700 dark:text-blue-300",children:["• Minimal Transaksi: ",e.jsx("strong",{children:"10.000"}),e.jsx("br",{}),"• Biaya produksi video: ",e.jsx("strong",{children:"7.500"}),e.jsx("br",{}),"• Sisa ",e.jsx("strong",{children:"2.500"})," dikonversi menjadi koin untuk video berikutnya"]})]})]})})]})]}),e.jsxs(E,{className:"bg-card shadow-xl border-0",children:[e.jsx(R,{className:"pb-4",children:e.jsxs($,{className:"flex items-center text-xl",children:[e.jsx(I,{className:"w-6 h-6 text-purple-600 mr-3"}),"Informasi Pembayaran"]})}),e.jsxs(D,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-foreground mb-4 flex items-center",children:[e.jsx(te,{className:"w-5 h-5 text-purple-600 mr-2"}),"Data Personal"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-foreground mb-2",children:["Email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(V,{type:"email",placeholder:"Masukkan email anda...",value:i,onChange:a=>{y(a.target.value),M()},className:"w-full"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-foreground mb-2",children:["Nomor Telepon ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(V,{type:"tel",placeholder:"Masukkan nomor anda...",value:l,onChange:a=>{g(a.target.value),M()},className:"flex-1"}),e.jsx(h,{variant:"default",disabled:i.trim()==="",onClick:H,className:"bg-purple-600 hover:bg-purple-700",children:"Verifikasi"})]})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-foreground mb-4 flex items-center",children:[e.jsx(B,{className:"w-5 h-5 text-purple-600 mr-2"}),"Metode Pembayaran"]}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:X.map(a=>e.jsx("div",{className:`p-4 border-2 rounded-xl cursor-pointer transition-all ${a.disabled?"border-gray-200 bg-gray-50 cursor-not-allowed opacity-60":d===a.id?"border-purple-500 bg-purple-50 dark:bg-purple-950/20 shadow-md":"border-gray-200 hover:border-purple-300 hover:shadow-sm"}`,onClick:()=>!a.disabled&&Q(a.id),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center mr-3 ${a.disabled?"bg-gray-200":d===a.id?"bg-purple-100":"bg-gray-100"}`,children:e.jsx("div",{className:a.disabled?"text-gray-400":d===a.id?"text-purple-600":"text-gray-600",children:a.icon})}),e.jsxs("div",{children:[e.jsx("h4",{className:`font-medium ${a.disabled?"text-gray-400":"text-foreground"}`,children:a.name}),e.jsx("p",{className:`text-sm ${a.disabled?"text-gray-400":"text-muted-foreground"}`,children:a.description}),a.balance&&e.jsx(F,{variant:"secondary",className:"mt-1 text-xs",children:a.balance})]})]}),d===a.id&&e.jsx("div",{className:"w-6 h-6 bg-purple-600 rounded-full flex items-center justify-center",children:e.jsx(P,{className:"w-4 h-4 text-white"})})]})},a.id))})]})]})]})]}),e.jsxs("div",{className:"flex justify-center space-x-4",children:[e.jsxs(h,{variant:"outline",size:"lg",className:"flex items-center space-x-2 px-8",onClick:()=>window.location.href="/",children:[e.jsx(re,{className:"w-4 h-4"}),e.jsx("span",{children:"Kembali"})]}),e.jsx(h,{size:"lg",className:`px-8 ${d==="coins"?"bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700":"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700"}`,disabled:!d||!b||d==="coins"&&(!n||c!==null&&c<7500)||d!=="coins"&&!n||v,onClick:()=>{console.log("Payment button clicked with state:",{selectedPaymentMethod:d,isPersonalInfoComplete:b,isOTPVerified:n,userQuota:c,email:i,phoneNumber:l,videoData:m.load()}),d==="coins"?U():W()},children:v?e.jsxs("span",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 animate-spin rounded-full border-2 border-white border-t-transparent"}),e.jsx("span",{children:"Memproses..."})]}):d==="coins"?e.jsxs("span",{className:"flex items-center space-x-2",children:[e.jsx(ie,{className:"w-4 h-4"}),e.jsx("span",{children:"Generate Video"})]}):e.jsxs("span",{className:"flex items-center space-x-2",children:[e.jsx(I,{className:"w-4 h-4"}),e.jsx("span",{children:"Bayar Sekarang"})]})})]}),e.jsx(oe,{isOpen:N,onClose:()=>p(!1),email:i,onSuccess:z})]})})}export{Se as PaymentPage};
