import{c as j,j as e,B as i,a as r}from"./createLucideIcon.DzqsC8J0.js";import{r as n}from"./index.CY-HDqYb.js";import{C as l,a as c,b as d,c as o}from"./card.DuY2Hr9W.js";import{t as F}from"./api.B5bR9fr5.js";import{v as I}from"./videoSetupStorage.CCIJS4Td.js";import{R as h}from"./refresh-cw.DIq2NuwJ.js";import{C as u,a as L}from"./clock.D6L3taSW.js";import{A,C as R}from"./circle-check-big.92E_O7pQ.js";import{C as V}from"./credit-card.CG7iAih-.js";import{F as z}from"./file-text.BpWd5Jfy.js";import{V as k}from"./video.DZgb2kyW.js";import{U as B}from"./user.BYLce_kR.js";import{M as E}from"./mail.BE_MjVYW.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],H=j("circle-x",q);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],$=j("dollar-sign",G);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],U=j("external-link",K);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],O=j("phone",J);function ce({invoiceNumber:p,onBack:f}){const[a,C]=n.useState(null),[t,_]=n.useState(null),[T,D]=n.useState(!0),[g,N]=n.useState(null),[m,y]=n.useState(!1),v=async()=>{try{N(null);const s=await F.getTransaction(p);if(s.status)C(s.data);else throw new Error(s.message||"Failed to fetch transaction")}catch(s){N(s instanceof Error?s.message:"Failed to fetch transaction")}finally{D(!1),y(!1)}},w=async()=>{y(!0),await v()};n.useEffect(()=>{v();const s=I.load();_(s)},[p]);const S=s=>{switch(s.toLowerCase()){case"success":case"paid":return e.jsx(R,{className:"w-5 h-5 text-green-600"});case"pending":return e.jsx(L,{className:"w-5 h-5 text-yellow-600"});case"failed":case"expired":return e.jsx(H,{className:"w-5 h-5 text-red-600"});default:return e.jsx(u,{className:"w-5 h-5 text-gray-600"})}},M=s=>{switch(s.toLowerCase()){case"success":case"paid":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200";case"pending":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200";case"failed":case"expired":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"}},P=s=>{switch(s.toLowerCase()){case"success":case"paid":return"Pembayaran Berhasil";case"pending":return"Menunggu Pembayaran";case"failed":return"Pembayaran Gagal";case"expired":return"Pembayaran Kedaluwarsa";default:return s}},x=s=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(s),b=s=>new Date(s).toLocaleString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return T?e.jsx("div",{className:"w-full",children:e.jsx("div",{className:"flex justify-center items-center min-h-[400px]",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(h,{className:"w-5 h-5 animate-spin"}),e.jsx("span",{children:"Memuat detail transaksi..."})]})})}):g?e.jsx("div",{className:"w-full",children:e.jsx("div",{className:"flex justify-center items-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx(u,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:"Gagal Memuat Transaksi"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:g}),e.jsx(i,{onClick:w,disabled:m,children:m?e.jsxs(e.Fragment,{children:[e.jsx(h,{className:"w-4 h-4 mr-2 animate-spin"}),"Memuat..."]}):e.jsxs(e.Fragment,{children:[e.jsx(h,{className:"w-4 h-4 mr-2"}),"Coba Lagi"]})})]})})}):a?e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[f&&e.jsxs(i,{variant:"outline",size:"sm",onClick:f,children:[e.jsx(A,{className:"w-4 h-4 mr-2"}),"Kembali"]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Detail Transaksi"}),e.jsxs("p",{className:"text-muted-foreground",children:["Invoice: ",a.invoice_number]})]})]}),e.jsxs(i,{variant:"outline",size:"sm",onClick:w,disabled:m,children:[e.jsx(h,{className:`w-4 h-4 mr-2 ${m?"animate-spin":""}`}),"Refresh"]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs(l,{children:[e.jsx(c,{children:e.jsxs(d,{className:"flex items-center space-x-2",children:[e.jsx(V,{className:"w-5 h-5"}),e.jsx("span",{children:"Status Transaksi"})]})}),e.jsx(o,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[S(a.transaction_status),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-foreground",children:P(a.transaction_status)}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.status_ref})]})]}),e.jsx(r,{className:M(a.transaction_status),children:a.transaction_status.toUpperCase()})]})})]}),e.jsxs(l,{children:[e.jsx(c,{children:e.jsxs(d,{className:"flex items-center space-x-2",children:[e.jsx($,{className:"w-5 h-5"}),e.jsx("span",{children:"Informasi Pembayaran"})]})}),e.jsxs(o,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Pembayaran"}),e.jsx("p",{className:"font-semibold text-lg text-foreground",children:x(a.total_payment)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Subtotal"}),e.jsx("p",{className:"font-semibold text-foreground",children:x(a.subtotal)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Biaya Admin"}),e.jsx("p",{className:"font-semibold text-foreground",children:x(a.total_fee)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Diskon"}),e.jsxs("p",{className:"font-semibold text-foreground",children:["-",x(a.promo)]})]})]}),e.jsx("div",{className:"pt-4 border-t",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Metode Pembayaran"}),e.jsx(r,{variant:"outline",children:a.payment_type})]})})]})]}),e.jsxs(l,{children:[e.jsx(c,{children:e.jsxs(d,{className:"flex items-center space-x-2",children:[e.jsx(z,{className:"w-5 h-5"}),e.jsx("span",{children:"Detail Transaksi"})]})}),e.jsxs(o,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Order ID"}),e.jsx("span",{className:"font-medium",children:a.order_id})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Tanggal Transaksi"}),e.jsx("span",{className:"font-medium",children:b(a.created_at)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Kedaluwarsa"}),e.jsx("span",{className:"font-medium",children:b(a.transaction_expired)})]}),a.payment_url&&e.jsx("div",{className:"pt-3 border-t",children:e.jsxs(i,{variant:"outline",size:"sm",className:"w-full",onClick:()=>{const s=window.open(a.payment_url,"payment","width=800,height=600,scrollbars=yes,resizable=yes,menubar=no,toolbar=no,location=no,status=no");s&&s.focus()},children:[e.jsx(U,{className:"w-4 h-4 mr-2"}),"Buka Halaman Pembayaran"]})}),a.transaction_status==="success"&&e.jsx("div",{className:"pt-3 border-t",children:e.jsxs(i,{size:"sm",className:"w-full bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700",onClick:()=>{window.location.href="/generate"},children:[e.jsx(k,{className:"w-4 h-4 mr-2"}),"Generate Video"]})})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(l,{children:[e.jsx(c,{children:e.jsxs(d,{className:"flex items-center space-x-2",children:[e.jsx(k,{className:"w-5 h-5"}),e.jsx("span",{children:"Detail Video"})]})}),e.jsx(o,{className:"space-y-4",children:t?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Judul Video"}),e.jsx("p",{className:"font-semibold text-foreground",children:t.judul_video||"Tidak ada judul"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Prompt"}),e.jsx("p",{className:"text-sm text-foreground bg-gray-50 dark:bg-gray-800 p-3 rounded-lg",children:t.prompt||"Tidak ada prompt"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Aspek Rasio"}),e.jsx(r,{variant:"outline",children:t.aspek_rasio})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Bahasa"}),e.jsx(r,{variant:"outline",children:t.bahasa})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Gaya Suara"}),e.jsx(r,{variant:"outline",children:t.gaya_suara})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Tone"}),e.jsx(r,{variant:"outline",children:t.tone})]})]})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(u,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-muted-foreground",children:"Data video tidak tersedia"})]})})]}),e.jsxs(l,{children:[e.jsx(c,{children:e.jsxs(d,{className:"flex items-center space-x-2",children:[e.jsx(B,{className:"w-5 h-5"}),e.jsx("span",{children:"Informasi Pelanggan"})]})}),e.jsx(o,{className:"space-y-3",children:t?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(E,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:t.email||"Tidak ada email"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(O,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:t.no_wa||"Tidak ada nomor telepon"})]})]}):e.jsx("div",{className:"text-center py-4",children:e.jsx("p",{className:"text-muted-foreground",children:"Data pelanggan tidak tersedia"})})})]})]})]})]}):e.jsx("div",{className:"w-full",children:e.jsx("div",{className:"flex justify-center items-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx(u,{className:"w-12 h-12 text-gray-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:"Transaksi Tidak Ditemukan"}),e.jsxs("p",{className:"text-muted-foreground",children:["Transaksi dengan nomor ",p," tidak ditemukan."]})]})})})}export{ce as TransactionDetail};
