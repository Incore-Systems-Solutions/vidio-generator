---
import Layout from "@/layouts/main.astro";
import { VideoDownload } from "@/components/VideoDownload";
import { Navbar } from "@/components/Navbar";

export const prerender = false;

const url = Astro.url.searchParams.get('url') || '';
const taskId = Astro.url.searchParams.get('taskId') || '';

// Decode the video URL
const videoUrl = url ? decodeURIComponent(url) : '';
---

<Layout content={{ title: "Download Video" }}>
  <main class="min-h-screen bg-background">
    <div class="container mx-auto px-4 py-8">
      <Navbar currentStep={4} />

      <div class="max-w-7xl mx-auto mt-8">
        {videoUrl && taskId ? (
          <VideoDownload
            videoUrl={videoUrl}
            taskId={taskId}
            client:load
          />
        ) : (
          <div class="text-center py-12">
            <h2 class="text-2xl font-bold text-foreground mb-4">
              Video tidak ditemukan
            </h2>
            <p class="text-muted-foreground">
              Silakan kembali ke halaman generate untuk melanjutkan.
            </p>
          </div>
        )}
      </div>
    </div>

    <footer class="bg-muted/50 border-t">
      <div class="container mx-auto px-4 py-6">
        <div class="text-center text-muted-foreground">
          <p>&copy; 2025 Video Generator. All rights reserved.</p>
        </div>
      </div>
    </footer>
  </main>
</Layout>
